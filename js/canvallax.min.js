/*! canvallax v2.0.0 ( built 2016-08-23 ) https://github.com/shshaw/Canvallax.js @preserve */
!function(e,t){"function"==typeof define&&define.amd?define(t):"undefined"!=typeof exports?module.exports=t():e.canvallax=t()}(this,function(){"use strict";function e(){var e,t=arguments,n=t[0]||{},r=t.length,i=1;for(1===r&&(n=this,i=0);r>i;i++)if(t[i])for(e in t[i])t[i].hasOwnProperty(e)&&(n[e]=t[i][e]);return n}function t(t,n,r){(arguments.length<=1||"boolean"==typeof n)&&(r=n,n=t,t=this);var i=e({},t,n),a=i.length,o=0;if(a&&r)for(i.children=[],i.length=0;a>o;o++)i[o]&&i[o].clone&&(i.children[o]=i[o].clone(),delete i[o]);return new t.constructor(i)}function n(e,t){function n(){return e.apply(this,t)}return n.prototype=e.prototype,new n}function r(){function r(t){var i,a=this,o=arguments.length,s=0;if(!(a instanceof r)){for(i=new Array(o);o>s;s++)i[s]=arguments[s];return n(r,i)}return 1===o&&e(a,t),a.fn=r.fn,a.init&&a.init.apply(a,arguments),a.playing&&a.play&&a.play(),a}for(var i,a=arguments.length,o=0,s={init:p,extend:e,clone:t};a>o;o++){i=arguments[o],i.prototype&&(i=i.prototype);for(var l in i)i.hasOwnProperty(l)&&(s[l]=i[l])}return s.constructor=r,r.fn=r.prototype=s,r}function i(t,n,r,a){if(!(this instanceof i))return new i(t,n,r,a);var o,s=this;if(e(s,a),s.target=t,s.to=r,!s.from){s.from={};for(o in r)s.from[o]=t[o]}return s.duration(n),s.ease=c.ease[s.ease]||s.ease,s.restart(),s}function a(e,t){var n=e.zIndex===t.zIndex?0:e.zIndex<t.zIndex?-1:1;return n||(e.z===t.z?0:e.z<t.z?-1:1)}var o=window,s=document,l=(s.documentElement,s.body),h=Array.prototype,c=o.canvallax=o.canvallax||{},u=o.requestAnimationFrame||o.webkitRequestAnimationFrame||o.mozRequestAnimationFrame||o.msRequestAnimationFrame||function(e){o.setTimeout(e,20)};if(!o.CanvasRenderingContext2D)return!1;o.clx=c;var f=Math.PI/180,d=2*Math.PI,p=function(){},g=typeof p,m=function(e){return typeof e===g};c.extend=e,c.clone=t,c.createClass=r;var v={length:0,splice:h.splice,indexOf:h.indexOf,push:h.push,sort:h.sort,unshift:h.unshift,add:function(e){for(var t=this,n=e&&e.length>-1&&Array.isArray(e)?e:arguments,r=n.length,i=0;r>i;i++)n[i]&&t.push(n[i]);return t},each:function(e,t){for(var n,r=this,i=this.length,a=0;i>a&&(n=t||r[a],e.call(n,r[a],a)!==!1);a++);return this},remove:function(e){for(var t,n=this,r=e&&e.length>-1&&Array.isArray(e)?e:arguments,i=r.length;i--;)t=n.indexOf(r[i]),t>-1&&n.splice(t,1);return n}},y=["width","height"],w={x:0,y:0,z:1,opacity:1,scale:1,rotation:0,addTo:function(e){for(var t=e&&e.length>-1&&Array.isArray(e)?e:arguments,n=t.length,r=0;n>r;r++)t[r]&&t[r].add&&t[r].add(this);return this},extend:e,set:e,render:function(e,t){if(e){var n,r=this,i=r.length,a=0;if(t=t||r.parent,e.save(),r.clearFrames&&r.clear&&r.clear(e,t),n=e.globalAlpha*r.opacity,n>0&&(r.clip&&r._clip(e,t),e.globalAlpha=n,r.blend&&(e.globalCompositeOperation=r.blend),(r.fixed||t&&t.transform(e,r.z))&&r.transform(e))){for(r.preRender&&r.preRender(e,t),r._render&&r._render(e,t);i>a;a++)r[a].render(e,r);r.postRender&&r.postRender(e,t)}return e.restore(),r}},getCanvas:function(){return this.canvas||(this.parent?this.parent.getCanvas():!1)},transformOrigin:"center center",calcTransformPoint:function(){for(var e,t,n=this,r=[0,0],i=n.transformOrigin.split(" "),a=0;2>a;a++)e=i[a],t="center"===e?.5:"right"===e||"bottom"===e?1:e.indexOf("%")?parseFloat(e)/100:0,t&&(r[a]=n[y[a]]*t);return r},getTransformPoint:function(e){var t=this,n=t._transformPoint,r=t.transformOrigin,i=Array.isArray(r);return i||t.width||t.height||!t.length||!t.parent?((e||!n||t._transformOrigin!==r)&&(n=i?r:t.calcTransformPoint(),t._transformOrigin=t.transformOrigin,t._transformPoint=n),n):t.parent.getTransformPoint()},getCoords:function(e){var t=this.x,n=this.y,r=this.offset,i=this.parent,a=!this.fixed&&i&&i.getCoords?i.getCoords(e):!1;return r&&(t+=r.x||0,n+=r.y||0),a&&(t+=a[0],n+=a[1]),i||void 0===e||(t*=e,n*=e),[t,n]},transform:function(e,t){var n,r,i=void 0!==t?t:this.scale;return 0>=i?!1:((1!==i||this.rotation%360!==0)&&(n=this.getCoords(t),r=this.getTransformPoint(),n[0]+=r[0],n[1]+=r[1],e.translate(n[0],n[1]),this.rotation&&e.rotate(this.rotation*f),e.scale(i,i),e.translate(-n[0],-n[1])),this)},_clip:function(e,t){var n=this;e.beginPath(),n.clip.render?(n.clip.parent=t||n,n.clip.render(e,t)):n.clip.call(n,e,t),e.clip()}},x=e({},v,{animate:function(){var e,t=x.length;if(!x.playing||0===t)return void x.stop();for(x.frame=u(x.animate);t--;)e=x[t],e&&e.playing&&e.render&&!e.render()&&e.stop()},play:function(){x.frame=x.frame||u(x.animate),x.playing=!0},stop:function(){x.playing=!1,x.frame=null},kill:function(){return x.stop(),x.splice(0)}});c.animations=x;var T={play:function(){this.playing=!0;var e=x.indexOf(this);return-1==e&&x[this.animateLast?"unshift":"push"](this),x.play(),this},stop:function(){this.playing=!1;var e=x.indexOf(this);return e>-1&&x.splice(e,1),this}};c.ease={linear:function(e){return e},inQuad:function(e){return e*e},outQuad:function(e){return e*(2-e)},inOutQuad:function(e){return.5>e?2*e*e:-1+(4-2*e)*e},inCubic:function(e){return e*e*e},outCubic:function(e){return--e*e*e+1},inOutCubic:function(e){return.5>e?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},inQuart:function(e){return e*e*e*e},outQuart:function(e){return 1- --e*e*e*e},inOutQuart:function(e){return.5>e?8*e*e*e*e:1-8*--e*e*e*e}},i.fn=i.prototype=e({},T,{repeat:0,ease:c.ease.inOutQuad,duration:function(e){return e?void(this._d=1e3*e):this._d/1e3},restart:function(e){var t=e?this.repeatDelay:this.delay;this._s=Date.now()+(t?1e3*t:0),this._p=0,this.onStart&&this.onStart(),this.play()},pause:function(){this._p=this._p||Date.now(),this.playing=!1},reverse:function(){this.reversed=!this.reversed,this.restart()},render:function(){var e,t,n,r=this,i=Date.now();if(r.playing){if(r._p&&(r._s+=i-r._p,r._p=0),i<r._s)return!0;e=(i-r._s)/r._d,e>1&&(e=1),t=r.ease(r.reversed?1-e:e);for(n in r.to)r.target[n]=r.from[n]+(r.to[n]-r.from[n])*t;if(r.onUpdate&&r.onUpdate()===!1)return!1;if(1===e){if(r.onComplete&&r.onComplete(),r.yoyo&&(r.reversed=!r.reversed),0===r.repeat)return!1;r.repeat>0&&r.repeat--,r.restart(!0)}return!0}}}),c.Animate=i,i.from=function(e,t,n,r){var a={};for(var o in n)a[o]=e[o];return r=r||{},r.from=n,new i(e,t,a,r)},i.fromTo=function(e,t,n,r,a){return a=a||{},a.from=n,new i(e,t,r,a)},w.to=w.animate=function(e,t,n){return new i(this,e,t,n)},w.from=function(e,t,n){return new i.from(this,e,t,n)},w.fromTo=function(e,t,n,r){return new i.fromTo(this,e,t,n,r)},c.Group=r(w,v,{type:"group",add:function(e){for(var t=this,n=e&&e.length>-1&&Array.isArray(e)?e:arguments,r=n.length,i=0;r>i;i++)n[i]&&(n[i].parent=t,t.push(n[i]));return t.sort(a)},init:function(e){e&&e.children&&this.add(e.children)}});var _="<style>.canvallax--fullscreen { position: fixed; top: 0; left: 0; z-index: -1; }</style>";c.Scene=r(c.Group,T,{type:"scene",parentElement:l,className:"",fullscreen:!0,includeStyles:!0,playing:!0,animateLast:!0,clearFrames:!0,clear:function(e){var t=this.fill;return t&&(e.fillStyle=t),e[this.fill?"fillRect":"clearRect"](0,0,this.width,this.height),this},resize:function(e,t){return this.width=this.canvas.width=e||this.width,this.height=this.canvas.height=t||this.height,this},resizeFullscreen:function(){return this.resize(o.innerWidth,o.innerHeight),this},init:function(e){var t=this;t.canvas||(t.canvas=s.createElement("canvas"),t.parentElement.insertBefore(t.canvas,t.parentElement.firstChild)),t.ctx=t.canvas.getContext("2d"),t.className+=" canvallax ",t.fullscreen?(t.resizeFullscreen(),o.addEventListener("resize",t.resizeFullscreen.bind(t)),_&&t.includeStyles&&(s.head.insertAdjacentHTML("afterbegin",_),_=null),t.className+=" canvallax--fullscreen "):t.resize(t.width||t.canvas.width,t.height||t.canvas.height),t.canvas.className+=t.className,e&&e.children&&t.add(e.children),t.render=t.render.bind(t,t.ctx,t)}}),c.Element=r(w,{type:"element",lineWidth:1,_render:function(e,t){var n=this;n.draw&&(e.beginPath(),n.draw(e,n.getCoords(n.z),t)),n.fill&&(m(n.fill)?n.fill(e,t):(e.fillStyle=n.fill,e.fill())),n.stroke&&(n.lineWidth&&(e.lineWidth=n.lineWidth),m(n.stroke)?n.stroke(e,t):(e.strokeStyle=n.stroke,e.stroke()))}});var b=c.createElement=r.bind(null,c.Element),z=.5522848,C=function(){var e=document.createElement("canvas"),t=e.getContext("2d");return"function"==typeof t.ellipse}(),A=function(e,t){e.ellipse(t[0]+this.width/2,t[1]+this.height/2,this.width/2,this.height/2,0,0,d)};C||(A=function(e,t){var n=this.width,r=this.height,i=t[0],a=t[1];if(n===r)e.arc(i+n/2,t[1]+n/2,n/2,0,d);else{var o=n/2*z,s=r/2*z,l=i+n,h=a+r,c=i+n/2,u=a+r/2;e.moveTo(i,u),e.bezierCurveTo(i,u-s,c-o,a,c,a),e.bezierCurveTo(c+o,a,l,u-s,l,u),e.bezierCurveTo(l,u+s,c+o,h,c,h),e.bezierCurveTo(c-o,h,i,u+s,i,u)}}),c.Ellipse=b({type:"ellipse",draw:A}),c.Rectangle=b({type:"rectangle",draw:function(e,t){e.rect(t[0],t[1],this.width,this.height)}}),c.Image=b({type:"image",onload:function(e){e.width=e.width?e.width:e.image.width,e.height=e.height?e.height:e.image.height},onerror:function(){this.removeAttribute("src")},init:function(e){var t=this.image;t=t&&1===t.nodeType?t:e&&1===e.nodeType?e:new Image,t instanceof HTMLCanvasElement||(t=t.cloneNode()),this.image=t,this.onload(this),t.onload=this.onload.bind(null,this),t.onerror=this.onerror,t.src=t.src||e.src||e},draw:function(e,t){this.image&&e.drawImage(this.image,t[0],t[1],this.width,this.height)}}),c.Polygon=b({type:"polygon",points:6,draw:function(e,t){var n,r,i,a,o=this.points,s=o.length,l=0;if(s)for(;s>l;l++)"close"===o[l]?e.closePath():e[0===l?"moveTo":"lineTo"](t[0]+o[l][0],t[1]+o[l][1]);else{for(n=this.width/2,r=this.height/2,i=t[0]+n,a=t[1]+r,e.moveTo(i+n,a);o>l;l++)e.lineTo(i+n*Math.cos(l*d/o),a+r*Math.sin(l*d/o));e.closePath()}}}),c.Tracker=r(v,T,{ease:0,scale:1,property:"offset",individual:!1,playing:!0,applyTracking:function(e,t){var n=this,r=e[n.property]||{},i={};if(t=t||n._render(e),!t)return!1;for(var a in t)i[a]=n.scale*(n.invert===!0||n.invert==="invert"+a?t[a]:-t[a])+(n.offset&&!isNaN(n.offset[a])?n.offset[a]:isNaN(n.offset)?0:n.offset),r[a]||(r[a]=0),r[a]=n.ease<=0?i[a]:r[a]+(i[a]-r[a])/(n.ease+1);return e[n.property]=r,this},render:function(){for(var e=this.length,t=0,n=this.individual?null:this._render();e>t;t++)this.applyTracking(this[t],n);return this}});var O=c.createTracker=r.bind(null,c.Tracker),k=0,E=0,P=!1,R=function(){k=o.pageXOffset,E=o.pageYOffset};c.TrackScroll=O({init:function(){P||(P=!0,R(),s.addEventListener("scroll",R))},_render:function(){var e=this.element;return{x:e?e.scrollLeft:k,y:e?e.scrollTop:E}}});var L=o.innerHeight,F=o.innerWidth,N=!1,S=function(){L=o.innerHeight,F=o.innerWidth},I=F/2,Q=L/2,W=!1,M=function(e){I=e.touches?e.touches[0].clientX:e.clientX,Q=e.touches?e.touches[0].clientY:e.clientY};c.TrackPointer=c.createTracker({range:!1,init:function(){W||(W=!0,s.addEventListener("mousemove",M),s.addEventListener("touchmove",M),s.addEventListener("touchstart",M)),N||(S(),o.addEventListener("resize",S))},_render:function(){var e=-I,t=-Q,n=this.range;return(n||0===n)&&(e=(I/F-.5)*-(n.x||n),t=(Q/L-.5)*-(n.y||n)),{x:e,y:t}}}),c.TrackElement=c.createTracker({init:function(e){var t=e&&e.element||e;this.element="string"==typeof t?document.querySelector(t):t},_render:function(){var e=this.element.getBoundingClientRect();return{x:-e.left,y:-e.top}}});for(var q=p,D=o._clx||[],H=D.length,X=0;H>X;X++)D[X](c);return q.push=function(e){e(c)},o._clx=q,c});